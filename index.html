<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monitor de Videos</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico" sizes="32x32">
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
    }

    .container {
      display: grid;
      grid-template-columns: repeat(2, 1fr); /* Dos columnas */
      grid-template-rows: repeat(2, 1fr); /* Dos filas */
      gap: 2px; /* Espacio entre los cuadrantes */
      height: 100vh; /* Altura total de la pantalla */
      background-color: black; /* Fondo negro para la cuadrícula */
    }

    .video-wrapper {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex; /* Contenedor flexible para alinear el video y el slider */
      align-items: center; /* Centrar verticalmente */
    }

    /* Ajuste de posición para los sliders */
    .video-wrapper:nth-child(odd) {
      flex-direction: row-reverse; /* Sliders a la izquierda para videos 1 y 3 */
    }

    .video-wrapper:nth-child(even) {
      flex-direction: row; /* Sliders a la derecha para videos 2 y 4 */
    }

    .video-container {
      position: relative;
      width: calc(100% - 20px); /* Dejar espacio para el slider */
      height: 100%;
      overflow: hidden;
      border: 7px solid black; /* Borde negro inicial */
      box-sizing: border-box; /* Incluir el borde en el cálculo del tamaño */
      transition: all 0.3s ease; /* Animación suave para cambios visuales */
    }

    .video-container.active {
      border: 7px solid red; /* Borde rojo más grueso para el video activo */
    }

    iframe {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      height: 100%;
      pointer-events: none; /* Desactivar interacciones directas con el iframe */
    }

    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      cursor: pointer; /* Indica que es interactivo */
      background: rgba(0, 0, 0, 0); /* Capa transparente */
    }

    /* Cambiar el color del slider */
    .volume-slider {
      width: 80px; /* Ancho del slider */
      height: 4px; /* Altura igual al contenedor */
      background: #333; /* Color de fondo del slider */
      outline: none;
      writing-mode: bt-lr; /* Forzar orientación vertical */
      direction: rtl; /* Invertir la dirección para que el valor máximo esté arriba */
      transform: rotate(90deg); /* Rotar el slider para que funcione correctamente */
      margin: 0 1px; /* Espacio entre el video y el slider */
      opacity: 0; /* Inicialmente invisible */
      transition: opacity 0.3s ease; /* Animación suave */
    }

    .volume-slider.visible {
      opacity: 1; /* Hacer visible el slider */
    }

    /* Estilo del thumb en navegadores basados en WebKit */
    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none; /* Personalizar el "pulgar" o "thumb" del slider */
      appearance: none;
      width: 15px;
      height: 15px;
      background: red; /* Color del pulgar */
      border-radius: 50%;
      cursor: pointer;
    }

    /* Estilo del thumb en Firefox */
    .volume-slider::-moz-range-thumb {
      width: 15px;
      height: 15px;
      background: red; /* Color del pulgar o thumb para Firefox */
      border-radius: 50%;
      cursor: pointer;
    }

    /* Contenedor del reproductor de radio (inferior) */
    .radio-container {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 165px; /* Altura restaurada a 165px */
      background-color: black; /* Fondo oscuro para coincidir con el diseño */
      z-index: 1000; /* Asegurarse de que esté encima de otros elementos */
      display: flex;
      justify-content: center; /* Centrar horizontalmente el iframe */
      align-items: center; /* Centrar verticalmente el iframe */
      transform: translateY(100%); /* Ocultar el widget por defecto */
      transition: transform 0.3s ease; /* Animación suave */
    }
    .radio-container iframe {
      width: 100%; /* Mantener el ancho completo */
      height: 165px; /* Altura ajustada para el iframe */
      border: none;
      pointer-events: auto; /* Habilitar interacciones */
    }
    /* Botón/indicador para activar el widget */
    .radio-trigger {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 50px; /* Ancho del contenedor */
      height: 30px; /* Altura del contenedor */
      background: linear-gradient(to bottom, rgba(255, 165, 0, 0.8), rgba(255, 70, 0, 0.8)); /* Color predeterminado: Naranja degradee con 80% de opacidad */
      border-radius: 15px 15px 0 0; /* Bordes redondeados */
      cursor: pointer;
      z-index: 1001; /* Encima del widget */
      text-align: center;
      line-height: 30px; /* Alinear texto verticalmente */
      font-size: 24px; /* Tamaño de fuente */
      color: white;
      transition: background-color 0.3s ease;
    }

    .radio-trigger:hover {
      background: linear-gradient(to bottom, rgba(255, 0, 0, 0.8), rgba(255, 165, 0, 0.8)); /* Cambiar color a Rojo degradee con 80% de opacidad al pasar el mouse */
    }

    /* Mostrar el widget al hacer clic en el indicador */
    .radio-container.visible {
      transform: translateY(0); /* Mover el widget hacia arriba */
    }

    /* Contenedor de configuraciones de la parte superior */
    .top-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 150px; /* Altura */
      background-color: black; /* Fondo oscuro para coincidir con el diseño */
      z-index: 1000; /* Asegurarse de que esté encima de otros elementos */
      display: flex;
      justify-content: center; /* Centrar horizontalmente el iframe */
      align-items: center; /* Centrar verticalmente el iframe */
      transform: translateY(-100%); /* Ocultar el widget por defecto */
      transition: transform 0.3s ease; /* Animación suave */
    }

    .top-container iframe {
      width: 100%; /* Mantener el ancho completo */
      height: 100px; /* Altura ajustada para el iframe */
      border: none;
      pointer-events: auto; /* Habilitar interacciones */
    }

    /* Botón/indicador para activar el widget superior */
    .top-trigger {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 40px; /* Ancho reducido */
      height: 28px; /* Altura reducida */
      background: rgba(0, 0, 255, 0.7); /* Azul sólido con 70% de opacidad */
      border-radius: 0 0 15px 15px; /* Bordes redondeados en la parte inferior */
      cursor: pointer;
      z-index: 1001; /* Encima del widget */
      text-align: center;
      line-height: 25px; /* Alinear texto verticalmente */
      font-size: 18px; /* Tamaño de fuente reducido */
      color: white; /* Color del ícono */
      transition: background-color 0.3s ease; /* Transición suave para el cambio de color */
    }

    .top-trigger:hover {
      background: rgba(0, 0, 255, 0.9); /* Azul sólido con 90% de opacidad al pasar el mouse */
    }

    /* Mostrar el frame superior al hacer clic en el indicador */
    .top-container.visible {
      transform: translateY(0); /* Mover el widget hacia abajo */
    }

/* Estilo para la tabla dentro del .top-container */
.top-container table {
  width: 100%;
  height: 100%;
  border-collapse: collapse; /* Eliminar bordes entre celdas */
  text-align: center;
  color: white; /* Color predeterminado del texto */
}

.top-container td {
  border: none; /* Bordes invisibles */
  padding: 5px;
  vertical-align: middle;
}

.top-container tr:nth-child(odd) {
  color: white; /* Filas 1 y 3: texto blanco */
}

.top-container tr:nth-child(even) {
  color: gray; /* Filas 2 y 4: texto gris */
}

.top-container input[type="text"] {
  width: 50%; /* Ajustar el ancho del cuadro de texto -- Mismo ancho que .video-select */
  padding: 2px;
  border: 1px solid gray; /* Borde gris */
  background-color: transparent; /* Fondo transparente */
  color: inherit; /* Heredar el color del texto */
  text-align: center; /* Centrar el texto */
}

/* ================================================ */
/* ESTILOS PERSONALIZADOS PARA LOS MENÚS DESPLEGABLES */
/* ================================================ */

/* Estilo para las listas desplegables - FONDO OSCURO Y TEXTO CLARO */
.video-select {
  width: 50%; /* Ancho del select */
  padding: 4px 6px; /* Mayor padding para mejor apariencia */
  border: 1px solid #555; /* Borde más oscuro */
  border-radius: 4px; /* Bordes redondeados */
  background-color: #2c3e50; /* Fondo oscuro azulado */
  color: #ecf0f1; /* Color de texto claro */
  text-align: center; /* Centrar el texto */
  font-size: 14px; /* Tamaño de fuente adecuado */
  cursor: pointer; /* Cursor de puntero para indicar que es interactivo */
  transition: all 0.3s ease; /* Transición suave para efectos hover */
  appearance: none; /* Eliminar estilo por defecto del navegador */
  -webkit-appearance: none; /* Para navegadores WebKit */
  -moz-appearance: none; /* Para Firefox */
  background-image: url('data:image/svg+xml;utf8,<svg fill="%23ecf0f1" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>'); /* Flecha personalizada */
  background-repeat: no-repeat; /* Evitar repetición de la imagen de fondo */
  background-position: right 8px center; /* Posición de la flecha */
  background-size: 16px; /* Tamaño de la flecha */
}

/* Estilo al pasar el mouse sobre el menú desplegable */
.video-select:hover {
  background-color: #34495e; /* Fondo un poco más claro al pasar el mouse */
  border-color: #777; /* Borde más claro al pasar el mouse */
}

/* Estilo cuando el menú desplegable está enfocado */
.video-select:focus {
  outline: none; /* Eliminar el contorno por defecto */
  border-color: #1abc9c; /* Cambiar color del borde al enfocar */
  box-shadow: 0 0 0 2px rgba(26, 188, 156, 0.3); /* Sutil sombra al enfocar */
}

/* Estilo para las opciones dentro del select - FONDO OSCURO Y TEXTO CLARO */
.video-select option {
  background-color: #2c3e50; /* Mismo fondo oscuro para las opciones */
  color: #ecf0f1; /* Mismo color de texto claro para las opciones */
  padding: 10px; /* Espaciado interno para las opciones */
  font-size: 14px; /* Tamaño de fuente consistente */
}

/* Estilo especial para la opción USUARIO */
.video-select option[value=""] {
  background-color: #e74c3c; /* Fondo rojo para la opción USUARIO */
  color: white; /* Texto blanco */
  font-weight: bold; /* Texto en negrita */
}

/* Estilo para los campos de ID */
.video-id {
  width: 90%; /* Ancho del cuadro de texto */
  padding: 2px; /* Mayor padding para mejor apariencia - era 8 */
  border: 1px solid #555; /* Borde más oscuro */
  border-radius: 4px; /* Bordes redondeados */
  background-color: #34495e; /* Fondo ligeramente diferente */
  color: #ecf0f1; /* Color de texto claro */
  text-align: center; /* Centrar el texto */
  font-family: monospace; /* Fuente monoespaciada para IDs */
  font-size: 14px; /* Tamaño de fuente adecuado */
  transition: all 0.3s ease; /* Transición suave para cambios */
}

/* Hacer el campo de ID editable cuando se selecciona "USUARIO" */
.video-id.editable {
  border: 1px solid #1abc9c; /* Borde verde cuando es editable */
  background-color: #2c3e50; /* Mismo fondo que los selects */
  color: white; /* Texto blanco */
}

/* ================================================ */
/* FIN DE ESTILOS PERSONALIZADOS */
/* ================================================ */

</style>
  
</head>
<body>
  <!-- Contenedor de los videos -->
  <div class="container">
    <!-- Los videos se generarán dinámicamente con JavaScript -->
  </div>
  
  <!-- Indicador para activar el widget superior -->
  <div class="top-trigger">⚙️</div>

<!-- Contenido de la parte superior -->
<div class="top-container">
  <table id="video-config-table">
    <!-- Las filas y celdas se generarán dinámicamente con JavaScript -->
  </table>
</div>
  
  <!-- Indicador para activar el widget inferior -->
  <div class="radio-trigger">📻</div>

  <!-- Reproductor de la parte inferior -->
  <div class="radio-container">
    <iframe 
      src=" https://public-player-widget.webradiosite.com/?cover=1&current_track=1&schedules=1&link=1&popup=1&share=1&embed=0&auto_play=0&source=7228&theme=dark&color=0&identifier=amigo&info=https%3A%2F%2Fpublic-player-widget.webradiosite.com%2Fapp%2Fplayer%2Finfo%2F250778%3Fhash%3D652003e86f1c29653d342c5bec793a5b0c68f0a1&locale=es-es" 
      border="0" 
      scrolling="no" 
      frameborder="0" 
      allow="autoplay; clipboard-write" 
      allowtransparency="true">
    </iframe>
  </div>

  <script>
    // ******* CONFIGURACIÓN PRINCIPAL - Solo modificar esta sección *******
    // Variables globales para los IDs y nombres de los videos
    const videos = [
      { name: "C5N", id: "Uo-ziJhrTvI" },
      { name: "A24", id: "ArKbAx1K-2U" },
      { name: "TN", id: "cb12KmMMDJA" },
      { name: "CANAL26", id: "jwEtUHVxbjU" },
      { name: "NACION+", id: "hexOV2Z0jvA" },
      { name: "CRONICA", id: "avly0uwZzOE" },
      { name: "TELEFE", id: "xo8GkZXtNV0" },
      { name: "EL11-ENTRE.RIOS", id: "nndzeKDSjuc" },
      { name: "QUIERO-MUSICA", id: "8Mw0YdKN2XY" },
      { name: "RADIO-MITRE", id: "ybXIVVg6epw" },
      { name: "RADIO-LA.RED", id: "9XHmu_TXck0" },
      { name: "URBANA.PLAY-FM", id: "eyo4p5HUOsY" }
      // Agregar más videos aquí si es necesario
    ];
    // *********************************************************************
    
    // Número de reproductores de video (modificar si se cambia la estructura HTML)
    const NUMBER_OF_PLAYERS = 4;
    
    // Variables globales para los reproductores de YouTube
    let players = [];
    let containers = [];
    let volumeSliders = [];

    // ********** NUEVA FUNCIÓN: Generar dinámicamente los contenedores de video **********
    /**
     * Genera dinámicamente la estructura HTML de los videos basándose en el array 'videos'
     * Elimina la necesidad de tener valores estáticos en el HTML
     */
    function initializeVideoContainers() {
      const container = document.querySelector('.container');
      container.innerHTML = ''; // Limpiar contenedor existente
      
      // Generar los contenedores de video dinámicamente
      for (let i = 0; i < NUMBER_OF_PLAYERS; i++) {
        const videoId = i < videos.length ? videos[i].id : '';
        
        const videoWrapper = document.createElement('div');
        videoWrapper.className = 'video-wrapper';
        
        const videoContainer = document.createElement('div');
        videoContainer.className = 'video-container';
        videoContainer.dataset.videoIndex = i;
        if (videoId) {
          videoContainer.dataset.videoId = videoId;
        }
        
        const iframe = document.createElement('iframe');
        iframe.id = `video${i+1}`;
        if (videoId) {
          iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&loop=1&playlist=${videoId}&enablejsapi=1`;
        }
        iframe.setAttribute('frameborder', '0');
        iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
        iframe.setAttribute('allowfullscreen', '');
        
        const overlay = document.createElement('div');
        overlay.className = 'overlay';
        
        const slider = document.createElement('input');
        slider.type = 'range';
        slider.className = 'volume-slider';
        slider.min = '0';
        slider.max = '100';
        slider.value = '100';
        slider.dataset.videoIndex = i;
        slider.disabled = true;
        
        videoContainer.appendChild(iframe);
        videoContainer.appendChild(overlay);
        videoWrapper.appendChild(videoContainer);
        videoWrapper.appendChild(slider);
        container.appendChild(videoWrapper);
      }
      
      // Actualizar las referencias a los elementos recién creados
      containers = document.querySelectorAll('.video-container');
      volumeSliders = document.querySelectorAll('.volume-slider');
      
      // Configurar los event listeners para los nuevos elementos
      setupEventListeners();
    }
    
    // ********** NUEVA FUNCIÓN: Configurar event listeners para los contenedores **********
    /**
     * Configura todos los event listeners para los elementos de video
     * Se llama después de generar dinámicamente los contenedores
     */
    function setupEventListeners() {
      // Agregar eventos de clic a cada capa superpuesta
      containers.forEach((container, index) => {
        const overlay = container.querySelector('.overlay');
        const videoId = container.dataset.videoId;
        const slider = volumeSliders[index];
        
        // Evento de clic simple
        overlay.addEventListener('click', () => {
          const currentPlayer = players[index];
          // Si el contenedor ya está activo, mutear el video
          if (container.classList.contains('active')) {
            currentPlayer.mute();
            container.classList.remove('active');
            slider.classList.remove('visible');
            slider.disabled = true;
            console.log('Video mutado:', videoId);
          } else {
            // Remover la clase 'active' de todos los contenedores
            containers.forEach((cont) => {
              cont.classList.remove('active');
            });
            // Ocultar y deshabilitar todos los sliders
            volumeSliders.forEach((s) => {
              s.classList.remove('visible');
              s.disabled = true;
            });
            // Silenciar todos los videos
            players.forEach((player) => {
              if (player && player.mute) player.mute();
            });
            // Quitar el mute al video seleccionado
            if (currentPlayer && currentPlayer.unMute) currentPlayer.unMute();
            // Agregar la clase 'active' al contenedor seleccionado
            container.classList.add('active');
            slider.classList.add('visible');
            slider.disabled = false;
            console.log('Video activado:', videoId);
          }
        });
        
        // Evento de doble clic
        overlay.addEventListener('dblclick', () => {
          const currentPlayer = players[index];
          // Mutear el video si está activo
          if (container.classList.contains('active')) {
            currentPlayer.mute();
            container.classList.remove('active');
            slider.classList.remove('visible');
            slider.disabled = true;
            console.log('Video mutado por doble clic:', videoId);
          }
          // Construir la URL del video con parámetros para pantalla completa
          const videoUrl = `https://www.youtube.com/watch?v=${videoId}&autoplay=1&fs=1`;
          // Abrir el enlace del video en una ventana emergente
          const popupWidth = 800;
          const popupHeight = 600;
          const left = (window.screen.width - popupWidth) / 2;
          const top = (window.screen.height - popupHeight) / 2;
          window.open(
            videoUrl,
            'VideoPopup',
            `width=${popupWidth},height=${popupHeight},left=${left},top=${top},resizable=yes`
          );
          console.log('Enlace abierto en ventana emergente:', videoUrl);
        });
      });
      
      // Agregar eventos a los controles de volumen
      volumeSliders.forEach((slider) => {
        const videoIndex = slider.dataset.videoIndex;
        slider.addEventListener('input', () => {
          const volume = slider.value / 100;
          const player = players[videoIndex];
          if (player && player.setVolume) {
            player.setVolume(volume * 100);
            console.log(`Volumen del video ${videoIndex} ajustado a:`, volume);
          }
        });
      });
    }
    
    // Cargar la API de YouTube
    function onYouTubeIframeAPIReady() {
      console.log('API de YouTube cargada correctamente.');
      
      // Inicializar solo los primeros NUMBER_OF_PLAYERS videos
      players = [];
      for (let i = 1; i <= NUMBER_OF_PLAYERS; i++) {
        if (i <= videos.length) {
          players.push(new YT.Player(`video${i}`, { 
            videoId: videos[i-1].id,
            events: { 'onReady': onPlayerReady }
          }));
        } else {
          // Si no hay suficientes videos en la configuración, crear un player vacío
          players.push(new YT.Player(`video${i}`, { 
            events: { 'onReady': onPlayerReady }
          }));
        }
      }
    }
    
    // Función que se ejecuta cuando los videos están listos
    function onPlayerReady(event) {
      const player = event.target;
      console.log('Video listo:', player.getIframe().id);
    
      // Silenciar todos los videos al iniciar
      player.mute();
      player.playVideo();
    }

    // Función para extraer el ID de un enlace de YouTube
    function extractYouTubeId(url) {
      // Patrones comunes para URLs de YouTube
      const patterns = [
        /(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&]+)/,
        /(?:youtube\.com\/embed\/)([^&]+)/,
        /(?:youtube\.com\/v\/)([^&]+)/
      ];
      
      for (const pattern of patterns) {
        const match = url.match(pattern);
        if (match && match[1]) {
          return match[1];
        }
      }
      
      return null;
    }
    
    // Generar dinámicamente la tabla de configuración
    function generateVideoConfigTable() {
      const table = document.querySelector(".top-container table");
      table.innerHTML = ''; // Limpiar tabla existente
    
      // Crear las filas y celdas de la tabla
      for (let i = 0; i < 2; i++) {
        // Primera fila: nombres de los videos
        const nameRow = document.createElement("tr");
        for (let j = 0; j < 2; j++) {
          const cell = document.createElement("td");
          const select = document.createElement("select");
          select.classList.add("video-select");
          select.dataset.videoIndex = i * 2 + j;
    
          // Agregar las opciones predefinidas desde el array videos
          videos.forEach((video) => {
            const option = document.createElement("option");
            option.value = video.id;
            option.textContent = video.name;
            select.appendChild(option);
          });
    
          // Agregar la opción "USUARIO"
          const userOption = document.createElement("option");
          userOption.value = "";
          userOption.textContent = "USUARIO";
          select.appendChild(userOption);
    
          // Añadir el ícono ⚙️ antes del select
          cell.innerHTML = "⚙️ ";
          cell.appendChild(select);
          nameRow.appendChild(cell);
        }
        table.appendChild(nameRow);
    
        // Segunda fila: IDs de los videos
        const idRow = document.createElement("tr");
        for (let j = 0; j < 2; j++) {
          const cell = document.createElement("td");
          const input = document.createElement("input");
          input.type = "text";
          input.classList.add("video-id");
          input.readOnly = true;
          
          // Asignar el ID correspondiente o vacío si no existe
          const videoIndex = i * 2 + j;
          input.value = videoIndex < videos.length ? videos[videoIndex].id : "";
          
          cell.appendChild(input);
          idRow.appendChild(cell);
        }
        table.appendChild(idRow);
      }
      
      // Agregar eventos a los selects
      const videoSelects = document.querySelectorAll(".video-select");
      const videoIds = document.querySelectorAll(".video-id");
    
      videoSelects.forEach((select) => {
        // Establecer la opción seleccionada por defecto
        const videoIndex = select.dataset.videoIndex;
        if (videoIndex < videos.length) {
          select.value = videos[videoIndex].id;
        }
        
        select.addEventListener("change", (event) => {
          const selectedValue = event.target.value;
          const videoIndex = event.target.dataset.videoIndex;
          const idInput = videoIds[videoIndex];
    
          if (selectedValue === "") {
            // Si se selecciona "USUARIO", mostrar cuadro de diálogo
            const youtubeLink = prompt("Por favor, pega el enlace de YouTube:");
            
            if (youtubeLink) {
              // Extraer el ID del video del enlace
              let videoId = extractYouTubeId(youtubeLink);
              
              if (videoId) {
                idInput.value = videoId;
                idInput.classList.remove("editable");
                idInput.readOnly = true;
                
                // Actualizar el reproductor de YouTube correspondiente
                const player = players[videoIndex];
                if (player && player.loadVideoById) {
                  player.loadVideoById(videoId);
                  player.mute();
                  player.playVideo();
                }
                
                // Actualizar el iframe
                const iframe = document.getElementById(`video${parseInt(videoIndex) + 1}`);
                iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&loop=1&playlist=${videoId}&enablejsapi=1`;
                
                // Actualizar el data-video-id del contenedor para el doble clic
                const container = document.querySelector(`.video-container[data-video-index="${videoIndex}"]`);
                if (container) {
                  container.dataset.videoId = videoId;
                }
              } else {
                alert("El enlace de YouTube no es válido. Por favor, ingresa un enlace válido.");
                // Restablecer la selección
                event.target.value = idInput.value || "";
              }
            } else {
              // Si el usuario cancela, restablecer la selección
              event.target.value = idInput.value || "";
            }
          } else {
            // Si se selecciona otro video, actualizar el ID automáticamente
            idInput.value = selectedValue;
            idInput.classList.remove("editable");
            idInput.readOnly = true;
    
            // Actualizar el reproductor de YouTube correspondiente
            const player = players[videoIndex];
            if (player && player.loadVideoById) {
              player.loadVideoById(selectedValue);
              player.mute();
              player.playVideo();
            }
    
            // Actualizar el iframe del video correspondiente
            const iframe = document.getElementById(`video${parseInt(videoIndex) + 1}`);
            iframe.src = `https://www.youtube.com/embed/${selectedValue}?autoplay=1&mute=1&controls=0&loop=1&playlist=${selectedValue}&enablejsapi=1`;
            
            // Actualizar el data-video-id del contenedor para el doble clic
            const container = document.querySelector(`.video-container[data-video-index="${videoIndex}"]`);
            if (container) {
              container.dataset.videoId = selectedValue;
            }
          }
        });
      });
    }
    
    // ********** NUEVA FUNCIÓN: Inicializar toda la página **********
    /**
     * Función principal que inicializa todos los componentes de la página
     * Se ejecuta cuando el DOM está completamente cargado
     */
    function initializePage() {
      // Generar dinámicamente los contenedores de video
      initializeVideoContainers();
      
      // Generar la tabla de configuración
      generateVideoConfigTable();
      
      // Cargar la API de YouTube
      const tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      const firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
      
      // Configurar los event listeners para los widgets (radio y configuración)
      const radioTrigger = document.querySelector('.radio-trigger');
      const radioContainer = document.querySelector('.radio-container');
      const topTrigger = document.querySelector('.top-trigger');
      const topContainer = document.querySelector('.top-container');
      
      radioTrigger.addEventListener('click', () => {
        radioContainer.classList.toggle('visible');
      });
      
      document.addEventListener('click', (event) => {
        if (!radioContainer.contains(event.target) && !radioTrigger.contains(event.target)) {
          radioContainer.classList.remove('visible');
        }
      });
      
      topTrigger.addEventListener('click', () => {
        topContainer.classList.toggle('visible');
      });
      
      document.addEventListener('click', (event) => {
        if (!topContainer.contains(event.target) && !topTrigger.contains(event.target)) {
          topContainer.classList.remove('visible');
        }
      });
    }
    
    // Iniciar la página cuando el DOM esté completamente cargado
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializePage);
    } else {
      initializePage();
    }
</script>
</body>
</html>









